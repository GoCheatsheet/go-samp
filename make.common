GC = $(GOGC)
LD = $(GOLD)
SUFF = $(GOSUFF)

here = $(shell pwd)
bottom = $(shell basename $(here))

ifndef TARG
TARG = $(bottom)
endif

O_FILES= \
	$(bottom).$(SUFF)

all:
	make $(TARG)

$(TARG): $(XO_FILES) $(O_FILES)
	$(LD) -o $@ $(O_FILES)
	@echo "Done. Executable is: $@"

$(XO_FILES): %.$(SUFF): %.go
	$(GC) -c $<

$(O_FILES): %.$(SUFF): %.go
	$(GC) -c $<

clean:
	rm -rf *.[$(OS)o] *.a [$(OS)].out _obj $(TARG) *.$(SUFF)

format:
	gofmt -w -spaces -tabwidth=2 *.go

