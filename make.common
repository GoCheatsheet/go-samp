GC = $(GOGC)
LD = $(GOLD)

ifndef TARG
TARG = main
endif

here = $(shell pwd)
bottom = $(shell basename $(here))

O_FILES= \
	$(bottom).8

all:
	make $(TARG)

$(TARG): $(XO_FILES) $(O_FILES)
	$(LD) -o $@ $(O_FILES)
	@echo "Done. Executable is: $@"

$(XO_FILES): %.8: %.go
	$(GC) -c $<

$(O_FILES): %.8: %.go
	$(GC) -c $<

clean:
	rm -rf *.[$(OS)o] *.a [$(OS)].out _obj $(TARG) *.8

